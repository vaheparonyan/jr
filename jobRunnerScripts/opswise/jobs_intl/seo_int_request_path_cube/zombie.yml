truncate_teradata_table:
  class: SQLExecute
  configuration:
    db:
      adapter: Teradata
      dsn: tdwb_dsn
    sql:
     - delete from sandbox.int_bld_session_metrics_rp_fcs where event_day_key = ${date_key};

load_int_bld_session_rp:
  class: SQLExecute
  dependencies:
    - truncate_teradata_table
  configuration:
    db:
      adapter: Teradata
      dsn: tdwb_dsn
    sql_file: load_int_bld_session_rp.sql

truncate_mysql:
  class: SQLExecute
  configuration:
    db:
      adapter: Mysql
      dsn: seo_analytics_dsn
    sql:
     - delete from seo_analytics.int_bld_session_metrics_rp_fcs where event_day_key = ${date_key};

load_mysql:
  class: ScriptTask
  dependencies:
    - truncate_mysql
    - load_int_bld_session_rp
  configuration:
    script: /home/juicer/groupon-seo-admin/script/copy_subset_to_mysql int_bld_session_metrics_rp_fcs event_day_key ${date_key} ${date_key}

create_seo_int_request_path_cube:
  class: SQLExecute
  dependencies:
    - load_mysql
  configuration:
    db:
      adapter: Mysql
      dsn: seo_analytics_dsn
    sql_file: cube_int_bld_session_metrics_rp_fcs.sql
